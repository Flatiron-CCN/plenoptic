import matplotlib.pyplot as plt
import numpy as np

# set the style
plt.style.use('fivethirtyeight')
plt.rcParams['axes.facecolor'] = 'white'
plt.rcParams['figure.facecolor'] = 'white'
plt.rcParams['axes.edgecolor'] = 'white'
plt.rcParams['savefig.facecolor'] = 'white'
plt.rcParams['savefig.edgecolor'] = 'white'
plt.rcParams['savefig.bbox'] = 'tight'

# 2-deg fundamentals (energy linear, 5nm stepsize) from Stockman & Sharpe 2000,
# downloaded from http://www.cvrl.org/cones.htm
CONES = {"nm": [400, 405, 410, 415, 420, 425, 430, 435, 440, 445, 450, 455,
                460, 465, 470, 475, 480, 485, 490, 495, 500, 505, 510, 515,
                520, 525, 530, 535, 540, 545, 550, 555, 560, 565, 570, 575,
                580, 585, 590, 595, 600, 605, 610, 615, 620, 625, 630, 635,
                640, 645, 650, 655, 660, 665, 670, 675, 680, 685, 690, 695,
                700],
         "L": [0.00240836, 0.00483339, 0.00872127, 0.0133837, 0.018448,
               0.0229317, 0.0281877, 0.0341054, 0.0402563, 0.044938, 0.0498639,
               0.0553418, 0.0647164, 0.0806894, 0.0994755, 0.118802, 0.140145,
               0.163952, 0.191556, 0.232926, 0.288959, 0.359716, 0.443683,
               0.536494, 0.628561, 0.70472, 0.77063, 0.825711, 0.881011,
               0.919067, 0.940198, 0.965733, 0.981445, 0.994486, 0.999993,
               0.99231, 0.969429, 0.955602, 0.927673, 0.885969, 0.833982,
               0.775103, 0.705713, 0.630773, 0.554224, 0.479941, 0.400711,
               0.327864, 0.265784, 0.213284, 0.165141, 0.124749, 0.0930085,
               0.06851, 0.0498661, 0.0358233, 0.025379, 0.0177201, 0.0121701,
               0.0084717, 0.00589749],
         "M": [0.00226991, 0.0047001, 0.00879369, 0.0145277, 0.0216649,
               0.0295714, 0.0394566, 0.0518199, 0.0647782, 0.0758812,
               0.0870524, 0.0981934, 0.116272, 0.144541, 0.175893, 0.205398,
               0.235754, 0.268063, 0.30363, 0.357061, 0.427764, 0.515587,
               0.61552, 0.719154, 0.81661, 0.88555, 0.935687, 0.968858,
               0.995217, 0.997193, 0.977193, 0.956583, 0.91775, 0.873205,
               0.813509, 0.740291, 0.653274, 0.572597, 0.492599, 0.411246,
               0.334429, 0.264872, 0.205273, 0.156243, 0.116641, 0.0855872,
               0.062112, 0.0444879, 0.0314282, 0.0218037, 0.015448, 0.010712,
               0.00730255, 0.00497179, 0.00343667, 0.00237617, 0.00163734,
               0.00112128, 0.000761051, 0.000525457, 0.000365317],
         "S": [0.0566498, 0.122451, 0.233008, 0.381363, 0.543618, 0.674474,
               0.802555, 0.903573, 0.99102, 0.991515, 0.955393, 0.86024,
               0.786704, 0.738268, 0.646359, 0.516411, 0.390333, 0.290322,
               0.211867, 0.160526, 0.122839, 0.0888965, 0.060821, 0.0428123,
               0.0292033, 0.0193912, 0.0126013, 0.00809453, 0.005089,
               0.00316893, 0.00195896, 0.00120277, 0.000740174, 0.000455979,
               0.0002818, 0.000175039, 0.000109454, 6.89991e-05, 4.39024e-05,
               2.82228e-05, 1.83459e-05, 1.20667e-05, 8.03488e-06, 5.41843e-06,
               np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan,
               np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan,
               np.nan]}


def plot_cone_fundamentals():
    _, ax = plt.subplots(1, 1, figsize=(8, 5))
    ax.plot(CONES['nm'], CONES['S'], c='b')
    ax.plot(CONES['nm'], CONES['M'], c='g')
    ax.plot(CONES['nm'], CONES['L'], c='r')
    ax.set(xlabel='Wavelength (nm)',
           ylabel='Cone sensitivity (arbitrary units)')
